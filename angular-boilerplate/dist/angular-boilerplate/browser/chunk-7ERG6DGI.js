import{a as D}from"./chunk-CCXWQ3M3.js";import{b as V,c as E,d as k,e as O,f as W,g as j,h as q,j as A}from"./chunk-JRTDSWL7.js";import{h as N}from"./chunk-H52KW6AO.js";import{h as I,j as F}from"./chunk-P5VQLAOY.js";import{$a as o,Ab as a,Bb as c,Eb as _,Gb as b,Hb as y,Mb as m,Ob as R,Qb as w,Rb as h,Sb as v,eb as l,jb as S,ob as g,qa as u,ra as f,rc as M,sc as P,vb as d,vc as T,zb as r}from"./chunk-H7CNO3QB.js";function B(i,e){if(i&1&&(r(0,"li"),m(1),a()),i&2){let s=e.$implicit;o(),R(" ",s," ")}}function L(i,e){if(i&1&&(r(0,"div",13)(1,"ul"),g(2,B,2,1,"li",14),a()()),i&2){let s=y();o(2),d("ngForOf",s.errorMessage)}}function G(i,e){i&1&&c(0,"span",15)}var x=class i{constructor(e,s,t,p){this.route=e;this.router=s;this.toastr=t;this.passwordResetService=p}resetToken="";email="";password="";passwordConfirmation="";errorMessage=[];isSubmitting=!1;ngOnInit(){this.resetToken=this.route.snapshot.paramMap.get("token")||"",this.email=this.route.snapshot.queryParamMap.get("email")||"",(!this.resetToken||!this.email)&&(this.toastr.error("Invalid password reset link"),this.router.navigate(["/password_resets/new"]))}handleSubmit(){this.isSubmitting=!0,this.passwordResetService.resetPassword(this.resetToken,{email:this.email,user:{password:this.password,password_confirmation:this.passwordConfirmation}}).subscribe({next:e=>{e.flash?.[0]==="danger"?this.toastr.error(e.flash[1]):e.error?this.errorMessage=e.error:e.flash?.[0]==="success"?(this.toastr.success("The password reset successfully, please try log in again"),this.router.navigate(["/login"])):(this.toastr.success("The password reset successfully, please try log in again"),this.router.navigate(["/login"])),this.isSubmitting=!1},error:e=>{console.error(e),this.toastr.error("Failed to reset password. Please try again."),this.isSubmitting=!1}})}static \u0275fac=function(s){return new(s||i)(l(I),l(F),l(N),l(D))};static \u0275cmp=S({type:i,selectors:[["app-password-resets"]],decls:19,vars:6,consts:[["resetForm","ngForm"],[1,"row"],[1,"col-md-6","col-md-offset-3"],[3,"ngSubmit"],["class","alert alert-danger",4,"ngIf"],["type","hidden","name","email",3,"value"],[1,"form-group","mb-3"],["for","password",1,"form-label"],["type","password","id","password","name","password","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","passwordConfirmation",1,"form-label"],["type","password","id","passwordConfirmation","name","passwordConfirmation","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status","aria-hidden","true",4,"ngIf"],[1,"alert","alert-danger"],[4,"ngFor","ngForOf"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(s,t){if(s&1){let p=_();r(0,"h1"),m(1,"Reset password"),a(),r(2,"div",1)(3,"div",2)(4,"form",3,0),b("ngSubmit",function(){return u(p),f(t.handleSubmit())}),g(6,L,3,1,"div",4),c(7,"input",5),r(8,"div",6)(9,"label",7),m(10,"Password"),a(),r(11,"input",8),v("ngModelChange",function(n){return u(p),h(t.password,n)||(t.password=n),f(n)}),a()(),r(12,"div",6)(13,"label",9),m(14,"Confirmation"),a(),r(15,"input",10),v("ngModelChange",function(n){return u(p),h(t.passwordConfirmation,n)||(t.passwordConfirmation=n),f(n)}),a()(),r(16,"button",11),g(17,G,1,0,"span",12),m(18," Update password "),a()()()()}s&2&&(o(6),d("ngIf",t.errorMessage.length>0),o(),d("value",t.email),o(4),w("ngModel",t.password),o(4),w("ngModel",t.passwordConfirmation),o(),d("disabled",t.isSubmitting),o(),d("ngIf",t.isSubmitting))},dependencies:[T,M,P,A,j,V,E,k,q,W,O],encapsulation:2})};export{x as PasswordResetsComponent};
